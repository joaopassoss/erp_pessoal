<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo Financeiro - ERP Pessoal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .text-tce-main { color: #059669; }
        .bg-tce-main { background-color: #059669; }
        .group:hover .group-hover\:block { display: block; }
        .chart-container {
            position: relative;
            height: 300px;
        }
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 flex flex-col min-h-screen">
    <div class="bg-emerald-950 text-emerald-100 py-1 text-xs border-b border-emerald-900">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex gap-4">
                <a href="#conteudo" class="hover:text-white transition">Ir para Conteúdo [1]</a>
                <a href="#menu" class="hover:text-white transition">Ir para Menu [2]</a>
            </div>
            <div class="flex gap-3 items-center">
                <button class="hover:text-white font-bold" title="Alto Contraste">◐</button>
                <button class="hover:text-white font-bold" title="Aumentar Fonte">A+</button>
                <button class="hover:text-white font-bold" title="Diminuir Fonte">A-</button>
                <span class="h-3 w-px bg-emerald-700 mx-1"></span>
                <span class="font-bold text-emerald-400">VLibras</span>
            </div>
        </div>
    </div>

    <header class="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-50">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center gap-3">
                    <div class="w-9 h-9 flex items-center justify-center font-bold">
                        <span class="text-2xl text-emerald-700">ERP</span>
                    </div>
                    <div class="flex flex-col leading-tight">
                        <span class="text-xm font-bold text-gray-800">Módulo Financeiro</span>
                    </div>
                </div>

                <nav class="hidden lg:flex items-center gap-1 text-sm font-medium text-gray-600">
                    <a href="/dashboard" class="px-3 py-2 hover:text-emerald-700 transition">Dashboard</a>
                    <a href="/profile" class="px-3 py-2 hover:text-emerald-700 transition">Perfil</a>
                </nav>

                <button class="lg:hidden p-2 text-gray-600"><i data-lucide="menu"></i></button>
            </div>
        </div>
    </header>

    <div class="bg-[#022c22] py-10 relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-emerald-900 to-[#022c22]"></div>
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/connected.png')]"></div>
        
        <div class="container mx-auto px-6 relative z-10">
            <h1 class="text-3xl font-bold text-white mb-2">Módulo Financeiro</h1>
            <nav class="flex text-sm text-emerald-200/80">
                <ol class="flex items-center gap-2">
                    <li><a href="/dashboard" class="hover:text-white">Início</a></li>
                    <li><i data-lucide="chevron-right" class="w-3 h-3"></i></li>
                    <li class="text-white font-medium">Financeiro</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="flex flex-grow">
        <!-- Sidebar -->
        <aside class="w-64 bg-emerald-900 text-white min-h-screen sticky top-20">
            <div class="p-4">
                <h4 class="font-bold mb-4 flex items-center gap-2">
                    <i data-lucide="wallet" class="w-5 h-5"></i>
                    Financeiro
                </h4>
                <nav class="space-y-1">
                    <a href="#" onclick="showSection('dashboard')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-800 text-white">
                        <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                        Dashboard
                    </a>
                    <a href="#" onclick="showSection('contas-pagar')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="credit-card" class="w-4 h-4"></i>
                        Contas a Pagar
                    </a>
                    <a href="#" onclick="showSection('contas-receber')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="dollar-sign" class="w-4 h-4"></i>
                        Contas a Receber
                    </a>
                    <a href="#" onclick="showSection('metas')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="target" class="w-4 h-4"></i>
                        Metas Financeiras
                    </a>
                    <a href="#" onclick="showSection('metas-mensais')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="calendar" class="w-4 h-4"></i>
                        Metas Mensais
                    </a>
                    <a href="#" onclick="showSection('investimentos')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="trending-up" class="w-4 h-4"></i>
                        Investimentos
                    </a>
                    <a href="#" onclick="showSection('relatorios')" class="nav-link flex items-center gap-2 px-3 py-2 rounded-lg text-emerald-100 hover:bg-emerald-800 hover:text-white transition">
                        <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
                        Relatórios
                    </a>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main id="conteudo" class="flex-1 p-6">
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center gap-3">
                    <button onclick="alterarMes(-1)" class="px-3 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition">
                        <i data-lucide="chevron-left" class="w-4 h-4"></i>
                    </button>
                    <button id="mes-atual-display" class="px-4 py-2 bg-tce-main text-white rounded-lg font-semibold flex items-center gap-2">
                        <i data-lucide="calendar" class="w-4 h-4"></i>
                        <span id="mes-nome">Dezembro 2024</span>
                    </button>
                    <button onclick="alterarMes(1)" class="px-3 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition">
                        <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </button>
                </div>
                <a href="/dashboard" class="px-4 py-2 border border-gray-300 hover:bg-gray-50 rounded-lg transition flex items-center gap-2">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i>
                    Voltar para a Principal
                </a>
            </div>
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="layout-dashboard" class="w-6 h-6"></i>
                        Dashboard Financeiro
                    </h2>
                    <div class="flex items-center gap-3">
                        <div class="flex border border-gray-300 rounded-lg overflow-hidden">
                            <input type="radio" class="hidden" name="dashboard-mode" id="dashboard-mensal" value="mensal" checked>
                            <label for="dashboard-mensal" class="px-4 py-2 border-r border-gray-300 hover:bg-gray-50 cursor-pointer flex items-center gap-1">
                                <i data-lucide="calendar" class="w-4 h-4"></i>Mensal
                            </label>
                            <input type="radio" class="hidden" name="dashboard-mode" id="dashboard-anual" value="anual">
                            <label for="dashboard-anual" class="px-4 py-2 border-r border-gray-300 hover:bg-gray-50 cursor-pointer flex items-center gap-1">
                                <i data-lucide="calendar-days" class="w-4 h-4"></i>Anual
                            </label>
                            <input type="radio" class="hidden" name="dashboard-mode" id="dashboard-total" value="total">
                            <label for="dashboard-total" class="px-4 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-1">
                                <i data-lucide="trending-up" class="w-4 h-4"></i>Total
                            </label>
                        </div>
                        <button onclick="loadDashboard()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                            <i data-lucide="refresh-cw" class="w-4 h-4"></i>Atualizar
                        </button>
                    </div>
                </div>

                <!-- Cards de Resumo -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="bg-gradient-to-br from-pink-500 to-red-500 text-white rounded-xl p-6 shadow-lg">
                        <div class="text-center">
                            <i data-lucide="wallet" class="w-8 h-8 mb-2 mx-auto"></i>
                            <h5 class="font-semibold mb-1" id="saldo-label">Saldo do Mês</h5>
                            <h3 class="text-2xl font-bold" id="saldo-atual">R$ 0,00</h3>
                            <p class="text-sm text-white/80 mt-1" id="saldo-periodo">Outubro 2024</p>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-500 to-cyan-500 text-white rounded-xl p-6 shadow-lg">
                        <div class="text-center">
                            <i data-lucide="arrow-up" class="w-8 h-8 mb-2 mx-auto"></i>
                            <h5 class="font-semibold mb-1" id="receitas-label">Receitas</h5>
                            <h3 class="text-2xl font-bold" id="receitas-mes">R$ 0,00</h3>
                            <p class="text-sm text-white/80 mt-1" id="receitas-periodo">Outubro 2024</p>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-emerald-500 text-white rounded-xl p-6 shadow-lg">
                        <div class="text-center">
                            <i data-lucide="arrow-down" class="w-8 h-8 mb-2 mx-auto"></i>
                            <h5 class="font-semibold mb-1" id="despesas-label">Despesas</h5>
                            <h3 class="text-2xl font-bold" id="despesas-mes">R$ 0,00</h3>
                            <p class="text-sm text-white/80 mt-1" id="despesas-periodo">Outubro 2024</p>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-yellow-500 to-orange-500 text-white rounded-xl p-6 shadow-lg">
                        <div class="text-center">
                            <i data-lucide="trending-up" class="w-8 h-8 mb-2 mx-auto"></i>
                            <h5 class="font-semibold mb-1" id="investimentos-label">Investimentos</h5>
                            <h3 class="text-2xl font-bold" id="total-investido">R$ 0,00</h3>
                            <p class="text-sm text-white/80 mt-1" id="investimentos-periodo">Outubro 2024</p>
                        </div>
                    </div>
                </div>

                <!-- Gráfico e Próximas Contas -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h5 class="font-semibold mb-4 flex items-center gap-2">
                            <i data-lucide="line-chart" class="w-5 h-5"></i>
                            Evolução Financeira (12 meses)
                        </h5>
                        <div class="chart-container">
                            <canvas id="graficoEvolucao"></canvas>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h5 class="font-semibold mb-4 flex items-center gap-2">
                            <i data-lucide="clock" class="w-5 h-5"></i>
                            Próximas Contas
                        </h5>
                        <div id="proximas-contas">
                            <p class="text-gray-500">Carregando...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contas a Pagar Section -->
            <div id="contas-pagar-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="credit-card" class="w-6 h-6"></i>
                        Contas a Pagar
                    </h2>
                    <div class="flex gap-2">
                        <button onclick="showModal('modalContaPagar')" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i>Nova Conta
                        </button>
                        <button onclick="showModal('modalContaParcelada')" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition flex items-center gap-2">
                            <i data-lucide="calendar" class="w-4 h-4"></i>Conta Parcelada
                        </button>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                            <select id="filtro-status-pagar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="pendente">Pendente</option>
                                <option value="pago">Pago</option>
                                <option value="vencido">Vencido</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                            <select id="filtro-categoria-pagar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todas</option>
                                <option value="alimentacao">Alimentação</option>
                                <option value="transporte">Transporte</option>
                                <option value="moradia">Moradia</option>
                                <option value="saude">Saúde</option>
                                <option value="educacao">Educação</option>
                                <option value="lazer">Lazer</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mês</label>
                            <select id="filtro-mes-pagar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="1">Janeiro</option>
                                <option value="2">Fevereiro</option>
                                <option value="3">Março</option>
                                <option value="4">Abril</option>
                                <option value="5">Maio</option>
                                <option value="6">Junho</option>
                                <option value="7">Julho</option>
                                <option value="8">Agosto</option>
                                <option value="9">Setembro</option>
                                <option value="10">Outubro</option>
                                <option value="11">Novembro</option>
                                <option value="12">Dezembro</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button onclick="filtrarContasPagar()" class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition flex items-center justify-center gap-2">
                                <i data-lucide="filter" class="w-4 h-4"></i>Filtrar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Lista de Contas -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <div id="lista-contas-pagar">
                        <p class="text-gray-500">Carregando contas...</p>
                    </div>
                </div>
            </div>

            <!-- Contas a Receber Section -->
            <div id="contas-receber-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="dollar-sign" class="w-6 h-6"></i>
                        Contas a Receber
                    </h2>
                    <button onclick="showModal('modalContaReceber')" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>Nova Conta
                    </button>
                </div>

                <!-- Filtros -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                            <select id="filtro-status-receber" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="pendente">Pendente</option>
                                <option value="pago">Recebido</option>
                                <option value="vencido">Vencido</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                            <select id="filtro-categoria-receber" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todas</option>
                                <option value="alimentacao">Alimentação</option>
                                <option value="transporte">Transporte</option>
                                <option value="moradia">Moradia</option>
                                <option value="saude">Saúde</option>
                                <option value="educacao">Educação</option>
                                <option value="lazer">Lazer</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mês</label>
                            <select id="filtro-mes-receber" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="1">Janeiro</option>
                                <option value="2">Fevereiro</option>
                                <option value="3">Março</option>
                                <option value="4">Abril</option>
                                <option value="5">Maio</option>
                                <option value="6">Junho</option>
                                <option value="7">Julho</option>
                                <option value="8">Agosto</option>
                                <option value="9">Setembro</option>
                                <option value="10">Outubro</option>
                                <option value="11">Novembro</option>
                                <option value="12">Dezembro</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button onclick="filtrarContasReceber()" class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition flex items-center justify-center gap-2">
                                <i data-lucide="filter" class="w-4 h-4"></i>Filtrar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Lista de Contas -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <div id="lista-contas-receber">
                        <p class="text-gray-500">Carregando contas...</p>
                    </div>
                </div>
                </div>

            <!-- Metas Financeiras Section -->
            <div id="metas-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="target" class="w-6 h-6"></i>
                        Metas Financeiras
                    </h2>
                    <button onclick="showModal('modalMeta')" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>Nova Meta
                    </button>
                </div>

                <!-- Cards de Metas -->
                <div id="lista-metas" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <p class="text-gray-500">Carregando metas...</p>
                </div>
            </div>

            <!-- Investimentos Section -->
            <div id="investimentos-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="trending-up" class="w-6 h-6"></i>
                        Investimentos
                    </h2>
                    <button onclick="showModal('modalInvestimento')" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>Novo Investimento
                    </button>
                </div>

                <!-- Filtros -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                            <select id="filtro-tipo-investimento" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="poupanca">Poupança</option>
                                <option value="cdb">CDB</option>
                                <option value="lci">LCI</option>
                                <option value="lca">LCA</option>
                                <option value="fundos">Fundos</option>
                                <option value="acoes">Ações</option>
                                <option value="cripto">Cripto</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                            <select id="filtro-status-investimento" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="">Todos</option>
                                <option value="true">Ativo</option>
                                <option value="false">Inativo</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button onclick="filtrarInvestimentos()" class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition flex items-center justify-center gap-2">
                                <i data-lucide="filter" class="w-4 h-4"></i>Filtrar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Lista de Investimentos -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <div id="lista-investimentos">
                        <p class="text-gray-500">Carregando investimentos...</p>
                    </div>
                </div>
                </div>

            <!-- Metas Mensais Section -->
            <div id="metas-mensais-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="calendar" class="w-6 h-6"></i>
                        Metas Mensais
                    </h2>
                    <button onclick="criarMetaMensal()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>Nova Meta Mensal
                    </button>
                </div>

                <div class="grid grid-cols-1 gap-6 mb-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h5 class="font-semibold mb-4 flex items-center gap-2">
                            <i data-lucide="target" class="w-5 h-5"></i>
                            Status das Metas do Mês
                        </h5>
                        <div id="status-metas-mensais">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span class="flex items-center gap-2 text-green-600"><i data-lucide="arrow-up" class="w-4 h-4"></i>Receitas</span>
                                        <span id="percentual-receita-mensal" class="font-semibold">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                        <div class="bg-green-500 h-2 rounded-full transition-all" id="barra-receita-mensal" style="width: 0%"></div>
                                    </div>
                                    <p class="text-xs text-gray-500" id="valor-receita-mensal">R$ 0,00 / R$ 0,00</p>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span class="flex items-center gap-2 text-red-600"><i data-lucide="arrow-down" class="w-4 h-4"></i>Despesas</span>
                                        <span id="percentual-despesa-mensal" class="font-semibold">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                        <div class="bg-red-500 h-2 rounded-full transition-all" id="barra-despesa-mensal" style="width: 0%"></div>
                                    </div>
                                    <p class="text-xs text-gray-500" id="valor-despesa-mensal">R$ 0,00 / R$ 0,00</p>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span class="flex items-center gap-2 text-blue-600"><i data-lucide="trending-up" class="w-4 h-4"></i>Investimentos</span>
                                        <span id="percentual-investimento-mensal" class="font-semibold">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                        <div class="bg-blue-500 h-2 rounded-full transition-all" id="barra-investimento-mensal" style="width: 0%"></div>
                                    </div>
                                    <p class="text-xs text-gray-500" id="valor-investimento-mensal">R$ 0,00 / R$ 0,00</p>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span class="flex items-center gap-2 text-yellow-600"><i data-lucide="piggy-bank" class="w-4 h-4"></i>Poupança</span>
                                        <span id="percentual-poupanca-mensal" class="font-semibold">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                        <div class="bg-yellow-500 h-2 rounded-full transition-all" id="barra-poupanca-mensal" style="width: 0%"></div>
                                    </div>
                                    <p class="text-xs text-gray-500" id="valor-poupanca-mensal">R$ 0,00 / R$ 0,00</p>
                                </div>
                            </div>
                            <div class="mt-4 text-center">
                                <span class="px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800" id="status-geral-mensal">Status: Regular</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h5 class="font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="list" class="w-5 h-5"></i>
                        Histórico de Metas Mensais
                    </h5>
                    <div id="lista-metas-mensais">
                        <p class="text-gray-500">Carregando metas mensais...</p>
                    </div>
                </div>
                </div>

            <!-- Relatórios Section -->
            <div id="relatorios-section" class="content-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        <i data-lucide="bar-chart-3" class="w-6 h-6"></i>
                        Relatórios
                    </h2>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h5 class="font-semibold mb-4 flex items-center gap-2">
                            <i data-lucide="pie-chart" class="w-5 h-5"></i>
                            Despesas por Categoria
                        </h5>
                        <div class="chart-container">
                            <canvas id="graficoCategorias"></canvas>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h5 class="font-semibold mb-4 flex items-center gap-2">
                            <i data-lucide="pie-chart" class="w-5 h-5"></i>
                            Receitas por Categoria
                        </h5>
                        <div class="chart-container">
                            <canvas id="graficoReceitas"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <footer class="bg-emerald-950 text-emerald-100 py-6 mt-auto">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-6">
                <div>
                    <h3 class="font-bold text-white mb-3">Sistema ERP</h3>
                    <p class="text-sm text-emerald-200/80">Gestão financeira pessoal</p>
                </div>
                <div>
                    <h3 class="font-bold text-white mb-3">Links Úteis</h3>
                    <ul class="space-y-1 text-sm text-emerald-200/80">
                        <li><a href="/dashboard" class="hover:text-white transition">Dashboard</a></li>
                        <li><a href="/profile" class="hover:text-white transition">Perfil</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-white mb-3">Contato</h3>
                    <p class="text-sm text-emerald-200/80">Suporte disponível 24/7</p>
                </div>
            </div>
            <div class="border-t border-emerald-800 pt-4 text-center text-sm text-emerald-200/60">
                <p>&copy; 2024 ERP Pessoal. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Modal Conta a Pagar -->
    <div id="modalContaPagar" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Nova Conta a Pagar</h5>
                <button type="button" onclick="document.getElementById('modalContaPagar').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formContaPagar">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <input type="text" id="descricaoPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                        <input type="text" id="valorPagar" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data de Vencimento</label>
                        <input type="date" id="vencimentoPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="categoriaPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="saude">Saúde</option>
                            <option value="educacao">Educação</option>
                            <option value="lazer">Lazer</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="observacoesPagar" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalContaPagar').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarContaPagar()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Conta a Receber -->
    <div id="modalContaReceber" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Nova Conta a Receber</h5>
                <button type="button" onclick="document.getElementById('modalContaReceber').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formContaReceber">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <input type="text" id="descricaoReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                        <input type="text" id="valorReceber" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data de Vencimento</label>
                        <input type="date" id="vencimentoReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="categoriaReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="saude">Saúde</option>
                            <option value="educacao">Educação</option>
                            <option value="lazer">Lazer</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="observacoesReceber" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalContaReceber').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarContaReceber()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Conta Parcelada -->
    <div id="modalContaParcelada" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Nova Conta Parcelada</h5>
                <button type="button" onclick="document.getElementById('modalContaParcelada').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formContaParcelada">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                            <input type="text" id="descricaoParcelada" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                            <select id="categoriaParcelada" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="alimentacao">Alimentação</option>
                                <option value="transporte">Transporte</option>
                                <option value="moradia">Moradia</option>
                                <option value="saude">Saúde</option>
                                <option value="educacao">Educação</option>
                                <option value="lazer">Lazer</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Total</label>
                            <input type="text" id="valorTotalParcelada" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Número de Parcelas</label>
                            <input type="number" id="totalParcelas" min="2" max="60" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor da Parcela</label>
                            <input type="text" id="valorParcelaCalculado" placeholder="R$ 0,00" readonly class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data da Primeira Parcela</label>
                            <input type="date" id="dataPrimeiraParcela" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                            <textarea id="observacoesParcelada" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                        </div>
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <div class="flex items-start gap-2">
                            <i data-lucide="info" class="w-5 h-5 text-blue-600 mt-0.5"></i>
                            <div>
                                <strong class="block text-blue-900 mb-2">Prévia das Parcelas:</strong>
                                <div id="previaParcelas" class="text-sm text-blue-800"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalContaParcelada').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarContaParcelada()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">Criar Parcelas</button>
            </div>
        </div>
    </div>

    <!-- Modal Meta Financeira -->
    <div id="modalMeta" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Nova Meta Financeira</h5>
                <button type="button" onclick="document.getElementById('modalMeta').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formMeta">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Título</label>
                        <input type="text" id="tituloMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <textarea id="descricaoMeta" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor da Meta</label>
                        <input type="text" id="valorMeta" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data de Início</label>
                            <input type="date" id="inicioMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data da Meta</label>
                            <input type="date" id="dataMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cor</label>
                        <input type="color" id="corMeta" value="#3B82F6" class="w-full h-10 border border-gray-300 rounded-lg cursor-pointer">
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalMeta').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarMeta()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Investimento -->
    <div id="modalInvestimento" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Novo Investimento</h5>
                <button type="button" onclick="document.getElementById('modalInvestimento').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formInvestimento">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome</label>
                        <input type="text" id="nomeInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                        <select id="tipoInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="poupanca">Poupança</option>
                            <option value="cdb">CDB</option>
                            <option value="lci">LCI</option>
                            <option value="lca">LCA</option>
                            <option value="fundos">Fundos</option>
                            <option value="acoes">Ações</option>
                            <option value="cripto">Cripto</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Investido</label>
                            <input type="text" id="valorInvestido" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Atual</label>
                            <input type="text" id="valorAtual" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data do Investimento</label>
                        <input type="date" id="dataInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rentabilidade Anual (%)</label>
                        <input type="number" id="rentabilidadeAnual" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="observacoesInvestimento" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalInvestimento').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarInvestimento()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Editar Conta a Pagar -->
    <div id="modalEditarContaPagar" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Editar Conta a Pagar</h5>
                <button type="button" onclick="document.getElementById('modalEditarContaPagar').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formEditarContaPagar">
                    <input type="hidden" id="editarContaPagarId">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <input type="text" id="editarDescricaoPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                        <input type="text" id="editarValorPagar" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data de Vencimento</label>
                        <input type="date" id="editarVencimentoPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="editarCategoriaPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="saude">Saúde</option>
                            <option value="educacao">Educação</option>
                            <option value="lazer">Lazer</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="editarStatusPagar" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="pendente">Pendente</option>
                            <option value="pago">Pago</option>
                            <option value="vencido">Vencido</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="editarObservacoesPagar" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalEditarContaPagar').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarEdicaoContaPagar()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Editar Conta a Receber -->
    <div id="modalEditarContaReceber" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Editar Conta a Receber</h5>
                <button type="button" onclick="document.getElementById('modalEditarContaReceber').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formEditarContaReceber">
                    <input type="hidden" id="editarContaReceberId">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <input type="text" id="editarDescricaoReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                        <input type="text" id="editarValorReceber" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data de Vencimento</label>
                        <input type="date" id="editarVencimentoReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="editarCategoriaReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="saude">Saúde</option>
                            <option value="educacao">Educação</option>
                            <option value="lazer">Lazer</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="editarStatusReceber" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="pendente">Pendente</option>
                            <option value="pago">Recebido</option>
                            <option value="vencido">Vencido</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="editarObservacoesReceber" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalEditarContaReceber').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarEdicaoContaReceber()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Editar Meta -->
    <div id="modalEditarMeta" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Editar Meta Financeira</h5>
                <button type="button" onclick="document.getElementById('modalEditarMeta').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formEditarMeta">
                    <input type="hidden" id="editarMetaId">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Título</label>
                        <input type="text" id="editarTituloMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <textarea id="editarDescricaoMeta" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor da Meta</label>
                        <input type="text" id="editarValorMeta" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data de Início</label>
                            <input type="date" id="editarInicioMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Data da Meta</label>
                            <input type="date" id="editarDataMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="editarStatusMeta" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="ativa">Ativa</option>
                            <option value="pausada">Pausada</option>
                            <option value="concluida">Concluída</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Cor</label>
                        <input type="color" id="editarCorMeta" value="#3B82F6" class="w-full h-10 border border-gray-300 rounded-lg cursor-pointer">
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalEditarMeta').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarEdicaoMeta()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Editar Investimento -->
    <div id="modalEditarInvestimento" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Editar Investimento</h5>
                <button type="button" onclick="document.getElementById('modalEditarInvestimento').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formEditarInvestimento">
                    <input type="hidden" id="editarInvestimentoId">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome</label>
                        <input type="text" id="editarNomeInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                        <select id="editarTipoInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="poupanca">Poupança</option>
                            <option value="cdb">CDB</option>
                            <option value="lci">LCI</option>
                            <option value="lca">LCA</option>
                            <option value="fundos">Fundos</option>
                            <option value="acoes">Ações</option>
                            <option value="cripto">Cripto</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Investido</label>
                            <input type="text" id="editarValorInvestido" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Atual</label>
                            <input type="text" id="editarValorAtual" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data do Investimento</label>
                        <input type="date" id="editarDataInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rentabilidade Anual (%)</label>
                        <input type="number" id="editarRentabilidadeAnual" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="editarAtivoInvestimento" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <option value="true">Ativo</option>
                            <option value="false">Inativo</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                        <textarea id="editarObservacoesInvestimento" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalEditarInvestimento').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarEdicaoInvestimento()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal Transação de Meta -->
    <div id="modalTransacaoMeta" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50" onclick="if(event.target === this) this.classList.add('hidden')">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center p-6 border-b border-gray-200">
                <h5 class="text-lg font-semibold">Adicionar Valor à Meta</h5>
                <button type="button" onclick="document.getElementById('modalTransacaoMeta').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="p-6">
                <form id="formTransacaoMeta">
                    <input type="hidden" id="metaIdTransacao">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                        <input type="text" id="valorTransacao" placeholder="R$ 0,00" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                        <input type="text" id="descricaoTransacao" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Data da Transação</label>
                        <input type="date" id="dataTransacao" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-2 p-6 border-t border-gray-200">
                <button type="button" onclick="document.getElementById('modalTransacaoMeta').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</button>
                <button type="button" onclick="salvarTransacaoMeta()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition">Salvar</button>
            </div>
        </div>
    </div>

    <script>
        // Inicializar Lucide Icons
        lucide.createIcons();

        // Variáveis globais
        let token = localStorage.getItem('token');
        let graficoEvolucao = null;
        let graficoCategorias = null;
        let graficoReceitas = null;

        // Configurar headers para requisições
        const headers = {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        };

        // Função para mostrar seções
        function showSection(sectionName) {
            // Esconder todas as seções
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remover classe active de todos os links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('bg-emerald-800', 'text-white');
                link.classList.add('text-emerald-100');
            });
            
            // Mostrar seção selecionada
            document.getElementById(sectionName + '-section').style.display = 'block';
            
            // Adicionar classe active ao link
            if (event && event.target) {
                event.target.classList.add('bg-emerald-800', 'text-white');
                event.target.classList.remove('text-emerald-100');
            }
            
            // Carregar dados da seção
            switch(sectionName) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'contas-pagar':
                    loadContasPagar();
                    break;
                case 'contas-receber':
                    loadContasReceber();
                    break;
                case 'metas':
                    loadMetas();
                    break;
                case 'investimentos':
                    loadInvestimentos();
                    break;
                case 'relatorios':
                    loadRelatorios();
                    break;
            }
        }

        // Função para mostrar modais
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                lucide.createIcons();
            }
        }

        // Função para formatar moeda
        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        // Função para aplicar máscara de moeda em inputs
        function aplicarMascaraMoeda(input) {
            input.addEventListener('input', function(e) {
                let valor = e.target.value.replace(/\D/g, '');
                if (valor.length > 0) {
                    valor = (parseInt(valor) / 100).toFixed(2);
                    valor = valor.replace('.', ',');
                    valor = valor.replace(/(\d)(\d{3})(\d{3}),/g, '$1.$2.$3,');
                    valor = valor.replace(/(\d)(\d{3}),/g, '$1.$2,');
                    e.target.value = 'R$ ' + valor;
                }
            });

            input.addEventListener('blur', function(e) {
                if (e.target.value === 'R$ ') {
                    e.target.value = '';
                }
            });

            input.addEventListener('focus', function(e) {
                if (e.target.value === '') {
                    e.target.value = 'R$ ';
                }
            });
        }

        // Função para converter valor formatado para número
        function converterMoedaParaNumero(valorFormatado) {
            if (!valorFormatado) return 0;
            return parseFloat(valorFormatado.replace('R$ ', '').replace(/\./g, '').replace(',', '.')) || 0;
        }

        // Função para formatar valor para input
        function formatarValorParaInput(valor) {
            if (!valor || valor === 0) return '';
            return formatarMoeda(valor);
        }

        // Função para formatar data
        function formatarData(data) {
            return new Date(data).toLocaleDateString('pt-BR');
        }

        // Função para obter status badge
        function getStatusBadge(status) {
            const statusMap = {
                'pendente': 'bg-yellow-100 text-yellow-800',
                'pago': 'bg-green-100 text-green-800',
                'vencido': 'bg-red-100 text-red-800',
                'cancelado': 'bg-gray-100 text-gray-800'
            };
            return `<span class="px-2 py-1 rounded-full text-xs font-medium ${statusMap[status] || 'bg-gray-100 text-gray-800'}">${status.toUpperCase()}</span>`;
        }

        // Carregar Dashboard
        async function loadDashboard() {
            try {
                // Obter modo selecionado
                const modo = obterModoDashboard();
                
                // Construir URL baseada no modo
                let url = '/api/financeiro/dashboard';
                if (modo === 'mensal') {
                    url += `?mes=${mesAtual}&ano=${anoAtual}&tipo=mensal`;
                } else if (modo === 'anual') {
                    url += `?ano=${anoAtual}&tipo=anual`;
                } else if (modo === 'total') {
                    url += `?tipo=total`;
                }
                
                const response = await fetch(url, { headers });
                const data = await response.json();
                
                // Atualizar labels e períodos
                atualizarLabelsDashboard(modo);
                
                // Atualizar valores
                document.getElementById('saldo-atual').textContent = formatarMoeda(data.saldo_atual);
                document.getElementById('receitas-mes').textContent = formatarMoeda(data.receitas_mes);
                document.getElementById('despesas-mes').textContent = formatarMoeda(data.despesas_mes);
                document.getElementById('total-investido').textContent = formatarMoeda(data.total_investido);
                
                // Carregar próximas contas
                const proximasContasHtml = data.proximas_contas.map(conta => `
                    <div class="flex justify-between items-center mb-3 pb-3 border-b border-gray-200 last:border-0">
                        <div>
                            <strong class="font-semibold">${conta.descricao}</strong>
                            <p class="text-sm text-gray-500 mt-1">Vence em ${formatarData(conta.data_vencimento)}</p>
                        </div>
                        <div class="text-right">
                            <strong class="font-bold block">${formatarMoeda(conta.valor)}</strong>
                            <div class="mt-1">${getStatusBadge(conta.status)}</div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('proximas-contas').innerHTML = proximasContasHtml || '<p class="text-gray-500">Nenhuma conta próxima</p>';
                
                // Carregar gráfico de evolução
                loadGraficoEvolucao();
                
            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
            }
        }

        // Carregar gráfico de evolução
        async function loadGraficoEvolucao() {
            try {
                const response = await fetch('/api/financeiro/graficos/mensal?meses=12', { headers });
                const data = await response.json();
                
                const ctx = document.getElementById('graficoEvolucao').getContext('2d');
                
                if (graficoEvolucao) {
                    graficoEvolucao.destroy();
                }
                
                graficoEvolucao = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: data.map(item => item.mes),
                        datasets: [{
                            label: 'Receitas',
                            data: data.map(item => item.receitas),
                            borderColor: 'rgb(75, 192, 192)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            tension: 0.1
                        }, {
                            label: 'Despesas',
                            data: data.map(item => item.despesas),
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return formatarMoeda(value);
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (error) {
                console.error('Erro ao carregar gráfico de evolução:', error);
            }
        }

        // Carregar Contas a Pagar
        async function loadContasPagar() {
            try {
                const response = await fetch(`/api/financeiro/contas-pagar?mes=${mesAtual}&ano=${anoAtual}`, { headers });
                const contas = await response.json();
                
                const contasHtml = contas.map(conta => `
                    <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4 hover:shadow-md transition">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-1">
                                    <h6 class="font-semibold">${conta.descricao}</h6>
                                    ${conta.is_parcelada ? 
                                        `<span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">Parcela ${conta.parcela_atual}/${conta.total_parcelas}</span>` : ''
                                    }
                                </div>
                                <p class="text-sm text-gray-500">${conta.categoria} • Vence em ${formatarData(conta.data_vencimento)}</p>
                                ${conta.is_parcelada ? 
                                    `<p class="text-xs text-gray-400 mt-1">Valor da parcela: ${formatarMoeda(conta.valor_parcela)}</p>` : ''
                                }
                            </div>
                            <div class="text-center md:text-right">
                                <div class="text-xl font-bold mb-2">${formatarMoeda(conta.valor)}</div>
                                <div class="mb-2">${getStatusBadge(conta.status)}</div>
                                <div class="flex gap-2 justify-center md:justify-end">
                                    <button onclick="editarContaPagar(${conta.id})" class="p-2 border border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                    </button>
                                    ${conta.is_parcelada && conta.status === 'pendente' ? 
                                        `<button onclick="anteciparParcela(${conta.id})" title="Antecipar Parcela" class="p-2 border border-yellow-300 text-yellow-600 rounded-lg hover:bg-yellow-50 transition">
                                            <i data-lucide="calendar-plus" class="w-4 h-4"></i>
                                        </button>` : ''
                                    }
                                    ${conta.status === 'pendente' ? 
                                        `<button onclick="marcarComoPago(${conta.id})" class="p-2 border border-green-300 text-green-600 rounded-lg hover:bg-green-50 transition">
                                            <i data-lucide="check" class="w-4 h-4"></i>
                                        </button>` : ''
                                    }
                                    <button onclick="deletarContaPagar(${conta.id})" class="p-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition">
                                        <i data-lucide="trash" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('lista-contas-pagar').innerHTML = contasHtml || '<p class="text-gray-500">Nenhuma conta encontrada</p>';
                lucide.createIcons();
                
            } catch (error) {
                console.error('Erro ao carregar contas a pagar:', error);
            }
        }

        // Carregar Contas a Receber
        async function loadContasReceber() {
            try {
                const response = await fetch(`/api/financeiro/contas-receber?mes=${mesAtual}&ano=${anoAtual}`, { headers });
                const contas = await response.json();
                
                const contasHtml = contas.map(conta => `
                    <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4 hover:shadow-md transition">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                            <div class="flex-1">
                                <h6 class="font-semibold mb-1">${conta.descricao}</h6>
                                <p class="text-sm text-gray-500">${conta.categoria} • Vence em ${formatarData(conta.data_vencimento)}</p>
                            </div>
                            <div class="text-center md:text-right">
                                <div class="text-xl font-bold mb-2">${formatarMoeda(conta.valor)}</div>
                                <div class="mb-2">${getStatusBadge(conta.status)}</div>
                                <div class="flex gap-2 justify-center md:justify-end">
                                    <button onclick="editarContaReceber(${conta.id})" class="p-2 border border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                    </button>
                                    ${conta.status === 'pendente' ? 
                                        `<button onclick="marcarComoRecebido(${conta.id})" class="p-2 border border-green-300 text-green-600 rounded-lg hover:bg-green-50 transition">
                                            <i data-lucide="check" class="w-4 h-4"></i>
                                        </button>` : ''
                                    }
                                    <button onclick="deletarContaReceber(${conta.id})" class="p-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition">
                                        <i data-lucide="trash" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('lista-contas-receber').innerHTML = contasHtml || '<p class="text-gray-500">Nenhuma conta encontrada</p>';
                lucide.createIcons();
                
            } catch (error) {
                console.error('Erro ao carregar contas a receber:', error);
            }
        }

        // Carregar Metas
        async function loadMetas() {
            try {
                const response = await fetch('/api/financeiro/metas', { headers });
                const metas = await response.json();
                
                const metasHtml = metas.map(meta => {
                    const progresso = (meta.valor_atual / meta.valor_meta) * 100;
                    const statusClass = meta.status === 'concluida' ? 'success' : 
                                      meta.status === 'pausada' ? 'warning' : 'primary';
                    
                    const statusBadgeClass = statusClass === 'success' ? 'bg-green-100 text-green-800' : 
                                             statusClass === 'warning' ? 'bg-yellow-100 text-yellow-800' : 
                                             'bg-blue-100 text-blue-800';
                    const progressBarClass = statusClass === 'success' ? 'bg-green-500' : 
                                             statusClass === 'warning' ? 'bg-yellow-500' : 
                                             'bg-blue-500';
                    return `
                        <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition">
                            <div class="flex justify-between items-start mb-3">
                                <h5 class="font-semibold text-lg">${meta.titulo}</h5>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${statusBadgeClass}">${meta.status.toUpperCase()}</span>
                            </div>
                            <p class="text-gray-600 mb-4">${meta.descricao || 'Sem descrição'}</p>
                            
                            <div class="mb-4">
                                <div class="flex justify-between mb-2 text-sm">
                                    <span class="text-gray-600">Progresso</span>
                                    <span class="font-medium">${formatarMoeda(meta.valor_atual)} / ${formatarMoeda(meta.valor_meta)}</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="${progressBarClass} h-2 rounded-full transition-all" style="width: ${Math.min(progresso, 100)}%"></div>
                                </div>
                            </div>
                            
                            <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                                <span class="text-sm text-gray-500">Meta: ${formatarData(meta.data_meta)}</span>
                                <div class="flex gap-2">
                                    <button onclick="editarMeta(${meta.id})" class="p-2 border border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                    </button>
                                    <button onclick="adicionarValorMeta(${meta.id})" class="p-2 border border-green-300 text-green-600 rounded-lg hover:bg-green-50 transition">
                                        <i data-lucide="plus" class="w-4 h-4"></i>
                                    </button>
                                    <button onclick="verTransacoesMeta(${meta.id})" class="p-2 border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-50 transition">
                                        <i data-lucide="history" class="w-4 h-4"></i>
                                    </button>
                                    <button onclick="deletarMeta(${meta.id})" class="p-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition">
                                        <i data-lucide="trash" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                document.getElementById('lista-metas').innerHTML = metasHtml || '<p class="text-gray-500">Nenhuma meta encontrada</p>';
                lucide.createIcons();
                
            } catch (error) {
                console.error('Erro ao carregar metas:', error);
            }
        }

        // Carregar Investimentos
        async function loadInvestimentos() {
            try {
                const response = await fetch(`/api/financeiro/investimentos?mes=${mesAtual}&ano=${anoAtual}`, { headers });
                const investimentos = await response.json();
                
                const investimentosHtml = investimentos.map(inv => {
                    const rentabilidade = ((inv.valor_atual - inv.valor_investido) / inv.valor_investido) * 100;
                    const rentabilidadeClass = rentabilidade >= 0 ? 'text-success' : 'text-danger';
                    
                    const rentabilidadeTailwind = rentabilidade >= 0 ? 'text-green-600' : 'text-red-600';
                    return `
                        <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4 hover:shadow-md transition">
                            <div class="flex flex-col md:flex-row md:items-center gap-4">
                                <div class="flex-1">
                                    <h6 class="font-semibold mb-1">${inv.nome}</h6>
                                    <p class="text-sm text-gray-500">${inv.tipo.toUpperCase()}</p>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold">${formatarMoeda(inv.valor_investido)}</div>
                                    <p class="text-xs text-gray-500">Investido</p>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold">${formatarMoeda(inv.valor_atual)}</div>
                                    <p class="text-xs text-gray-500">Atual</p>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold ${rentabilidadeTailwind}">${rentabilidade.toFixed(2)}%</div>
                                    <p class="text-xs text-gray-500">Rentabilidade</p>
                                </div>
                                <div class="text-center md:text-right">
                                    <div class="mb-2">
                                        <span class="px-2 py-1 rounded-full text-xs font-medium ${inv.ativo ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">${inv.ativo ? 'ATIVO' : 'INATIVO'}</span>
                                    </div>
                                    <div class="flex gap-2 justify-center md:justify-end">
                                        <button onclick="editarInvestimento(${inv.id})" class="p-2 border border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition">
                                            <i data-lucide="edit" class="w-4 h-4"></i>
                                        </button>
                                        <button onclick="deletarInvestimento(${inv.id})" class="p-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition">
                                            <i data-lucide="trash" class="w-4 h-4"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                document.getElementById('lista-investimentos').innerHTML = investimentosHtml || '<p class="text-gray-500">Nenhum investimento encontrado</p>';
                lucide.createIcons();
                
            } catch (error) {
                console.error('Erro ao carregar investimentos:', error);
            }
        }

        // Carregar Relatórios
        async function loadRelatorios() {
            try {
                // Carregar relatório de despesas por categoria
                const responseDespesas = await fetch('/api/financeiro/relatorios/categorias?tipo=despesas', { headers });
                const despesas = await responseDespesas.json();
                
                // Carregar relatório de receitas por categoria
                const responseReceitas = await fetch('/api/financeiro/relatorios/categorias?tipo=receitas', { headers });
                const receitas = await responseReceitas.json();
                
                // Gráfico de despesas
                const ctxDespesas = document.getElementById('graficoCategorias').getContext('2d');
                if (graficoCategorias) {
                    graficoCategorias.destroy();
                }
                
                graficoCategorias = new Chart(ctxDespesas, {
                    type: 'doughnut',
                    data: {
                        labels: despesas.map(item => item.categoria),
                        datasets: [{
                            data: despesas.map(item => item.total),
                            backgroundColor: [
                                '#FF6384',
                                '#36A2EB',
                                '#FFCE56',
                                '#4BC0C0',
                                '#9966FF',
                                '#FF9F40',
                                '#FF6384'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                
                // Gráfico de receitas
                const ctxReceitas = document.getElementById('graficoReceitas').getContext('2d');
                if (graficoReceitas) {
                    graficoReceitas.destroy();
                }
                
                graficoReceitas = new Chart(ctxReceitas, {
                    type: 'doughnut',
                    data: {
                        labels: receitas.map(item => item.categoria),
                        datasets: [{
                            data: receitas.map(item => item.total),
                            backgroundColor: [
                                '#4BC0C0',
                                '#36A2EB',
                                '#FFCE56',
                                '#FF6384',
                                '#9966FF',
                                '#FF9F40',
                                '#4BC0C0'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                
            } catch (error) {
                console.error('Erro ao carregar relatórios:', error);
            }
        }

        // Funções de CRUD para Contas a Pagar
        async function salvarContaPagar() {
            const conta = {
                descricao: document.getElementById('descricaoPagar').value,
                valor: converterMoedaParaNumero(document.getElementById('valorPagar').value),
                data_vencimento: document.getElementById('vencimentoPagar').value,
                categoria: document.getElementById('categoriaPagar').value,
                observacoes: document.getElementById('observacoesPagar').value
            };
            
            try {
                const response = await fetch('/api/financeiro/contas-pagar', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(conta)
                });
                
                if (response.ok) {
                    document.getElementById('modalContaPagar').classList.add('hidden');
                    document.getElementById('modalContaPagar').classList.remove('flex');
                    document.getElementById('formContaPagar').reset();
                    loadContasPagar();
                }
            } catch (error) {
                console.error('Erro ao salvar conta a pagar:', error);
            }
        }

        // Funções para Conta Parcelada
        function calcularValorParcela() {
            const valorTotal = converterMoedaParaNumero(document.getElementById('valorTotalParcelada').value);
            const totalParcelas = parseInt(document.getElementById('totalParcelas').value);
            
            if (valorTotal && totalParcelas) {
                const valorParcela = valorTotal / totalParcelas;
                document.getElementById('valorParcelaCalculado').value = formatarValorParaInput(valorParcela);
                gerarPreviaParcelas();
            }
        }

        function gerarPreviaParcelas() {
            const valorTotal = converterMoedaParaNumero(document.getElementById('valorTotalParcelada').value);
            const totalParcelas = parseInt(document.getElementById('totalParcelas').value);
            const dataPrimeira = document.getElementById('dataPrimeiraParcela').value;
            
            if (valorTotal && totalParcelas && dataPrimeira) {
                const valorParcela = valorTotal / totalParcelas;
                const dataInicial = new Date(dataPrimeira);
                
                let previa = '<div class="grid grid-cols-1 md:grid-cols-2 gap-2">';
                for (let i = 0; i < Math.min(totalParcelas, 6); i++) {
                    const dataVencimento = new Date(dataInicial);
                    dataVencimento.setMonth(dataVencimento.getMonth() + i);
                    
                    previa += `
                        <div class="text-sm text-gray-600">
                            Parcela ${i + 1}: ${formatarValorParaInput(valorParcela)} - 
                            ${dataVencimento.toLocaleDateString('pt-BR')}
                        </div>
                    `;
                }
                
                if (totalParcelas > 6) {
                    previa += `
                        <div class="col-span-2 text-sm text-gray-500">
                            ... e mais ${totalParcelas - 6} parcelas
                        </div>
                    `;
                }
                
                previa += '</div>';
                document.getElementById('previaParcelas').innerHTML = previa;
            }
        }

        async function salvarContaParcelada() {
            const conta = {
                descricao: document.getElementById('descricaoParcelada').value,
                valor_total: converterMoedaParaNumero(document.getElementById('valorTotalParcelada').value),
                data_vencimento_primeira: document.getElementById('dataPrimeiraParcela').value,
                categoria: document.getElementById('categoriaParcelada').value,
                total_parcelas: parseInt(document.getElementById('totalParcelas').value),
                observacoes: document.getElementById('observacoesParcelada').value
            };
            
            try {
                const response = await fetch('/api/financeiro/contas-pagar/parcelada', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(conta)
                });
                
                if (response.ok) {
                    const parcelas = await response.json();
                    document.getElementById('modalContaParcelada').classList.add('hidden');
                    document.getElementById('modalContaParcelada').classList.remove('flex');
                    document.getElementById('formContaParcelada').reset();
                    document.getElementById('previaParcelas').innerHTML = '';
                    loadContasPagar();
                    alert(`Conta parcelada criada com sucesso! ${parcelas.length} parcelas foram geradas.`);
                } else {
                    const error = await response.json();
                    alert('Erro ao criar conta parcelada: ' + error.detail);
                }
            } catch (error) {
                console.error('Erro ao salvar conta parcelada:', error);
                alert('Erro ao criar conta parcelada');
            }
        }

        function verParcelas(contaId) {
            // Implementar visualização das parcelas
            window.location.href = `/financeiro/parcelas/${contaId}`;
        }

        async function anteciparParcela(parcelaId) {
            const novaData = prompt('Digite a nova data de vencimento (DD/MM/AAAA):');
            if (novaData) {
                try {
                    const [dia, mes, ano] = novaData.split('/');
                    const dataFormatada = `${ano}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;
                    
                    const response = await fetch(`/api/financeiro/contas-pagar/${parcelaId}/antecipar`, {
                        method: 'PUT',
                        headers,
                        body: JSON.stringify({
                            parcela_id: parcelaId,
                            nova_data_vencimento: dataFormatada
                        })
                    });
                    
                    if (response.ok) {
                        loadContasPagar();
                        alert('Parcela antecipada com sucesso!');
                    } else {
                        alert('Erro ao antecipar parcela');
                    }
                } catch (error) {
                    console.error('Erro ao antecipar parcela:', error);
                    alert('Erro ao antecipar parcela');
                }
            }
        }

        async function marcarComoPago(contaId) {
            try {
                const response = await fetch(`/api/financeiro/contas-pagar/${contaId}/pagar`, {
                    method: 'POST',
                    headers
                });
                
                if (response.ok) {
                    loadContasPagar();
                }
            } catch (error) {
                console.error('Erro ao marcar como pago:', error);
            }
        }

        async function deletarContaPagar(contaId) {
            if (confirm('Tem certeza que deseja deletar esta conta?')) {
                try {
                    const response = await fetch(`/api/financeiro/contas-pagar/${contaId}`, {
                        method: 'DELETE',
                        headers
                    });
                    
                    if (response.ok) {
                        loadContasPagar();
                    }
                } catch (error) {
                    console.error('Erro ao deletar conta a pagar:', error);
                }
            }
        }

        // Funções de CRUD para Contas a Receber
        async function salvarContaReceber() {
            const conta = {
                descricao: document.getElementById('descricaoReceber').value,
                valor: converterMoedaParaNumero(document.getElementById('valorReceber').value),
                data_vencimento: document.getElementById('vencimentoReceber').value,
                categoria: document.getElementById('categoriaReceber').value,
                observacoes: document.getElementById('observacoesReceber').value
            };
            
            try {
                const response = await fetch('/api/financeiro/contas-receber', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(conta)
                });
                
                if (response.ok) {
                    document.getElementById('modalContaReceber').classList.add('hidden');
                    document.getElementById('modalContaReceber').classList.remove('flex');
                    document.getElementById('formContaReceber').reset();
                    loadContasReceber();
                }
            } catch (error) {
                console.error('Erro ao salvar conta a receber:', error);
            }
        }

        async function marcarComoRecebido(contaId) {
            try {
                const response = await fetch(`/api/financeiro/contas-receber/${contaId}/receber`, {
                    method: 'POST',
                    headers
                });
                
                if (response.ok) {
                    loadContasReceber();
                }
            } catch (error) {
                console.error('Erro ao marcar como recebido:', error);
            }
        }

        async function deletarContaReceber(contaId) {
            if (confirm('Tem certeza que deseja deletar esta conta?')) {
                try {
                    const response = await fetch(`/api/financeiro/contas-receber/${contaId}`, {
                        method: 'DELETE',
                        headers
                    });
                    
                    if (response.ok) {
                        loadContasReceber();
                    }
                } catch (error) {
                    console.error('Erro ao deletar conta a receber:', error);
                }
            }
        }

        // Funções de CRUD para Metas
        async function salvarMeta() {
            const meta = {
                titulo: document.getElementById('tituloMeta').value,
                descricao: document.getElementById('descricaoMeta').value,
                valor_meta: converterMoedaParaNumero(document.getElementById('valorMeta').value),
                data_inicio: document.getElementById('inicioMeta').value,
                data_meta: document.getElementById('dataMeta').value,
                cor: document.getElementById('corMeta').value
            };
            
            try {
                const response = await fetch('/api/financeiro/metas', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(meta)
                });
                
                if (response.ok) {
                    document.getElementById('modalMeta').classList.add('hidden');
                    document.getElementById('modalMeta').classList.remove('flex');
                    document.getElementById('formMeta').reset();
                    loadMetas();
                }
            } catch (error) {
                console.error('Erro ao salvar meta:', error);
            }
        }

        async function adicionarValorMeta(metaId) {
            document.getElementById('metaIdTransacao').value = metaId;
            document.getElementById('dataTransacao').value = new Date().toISOString().split('T')[0];
            showModal('modalTransacaoMeta');
        }

        async function salvarTransacaoMeta() {
            const transacao = {
                meta_id: parseInt(document.getElementById('metaIdTransacao').value),
                valor: converterMoedaParaNumero(document.getElementById('valorTransacao').value),
                descricao: document.getElementById('descricaoTransacao').value,
                data_transacao: document.getElementById('dataTransacao').value
            };
            
            try {
                const response = await fetch(`/api/financeiro/metas/${transacao.meta_id}/transacoes`, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(transacao)
                });
                
                if (response.ok) {
                    document.getElementById('modalTransacaoMeta').classList.add('hidden');
                    document.getElementById('modalTransacaoMeta').classList.remove('flex');
                    document.getElementById('formTransacaoMeta').reset();
                    loadMetas();
                }
            } catch (error) {
                console.error('Erro ao salvar transação de meta:', error);
            }
        }

        async function deletarMeta(metaId) {
            if (confirm('Tem certeza que deseja deletar esta meta? Todas as transações relacionadas também serão deletadas.')) {
                try {
                    const response = await fetch(`/api/financeiro/metas/${metaId}`, {
                        method: 'DELETE',
                        headers
                    });
                    
                    if (response.ok) {
                        loadMetas();
                    }
                } catch (error) {
                    console.error('Erro ao deletar meta:', error);
                }
            }
        }

        // Funções de CRUD para Investimentos
        async function salvarInvestimento() {
            const investimento = {
                nome: document.getElementById('nomeInvestimento').value,
                tipo: document.getElementById('tipoInvestimento').value,
                valor_investido: converterMoedaParaNumero(document.getElementById('valorInvestido').value),
                valor_atual: converterMoedaParaNumero(document.getElementById('valorAtual').value),
                data_investimento: document.getElementById('dataInvestimento').value,
                rentabilidade_anual: parseFloat(document.getElementById('rentabilidadeAnual').value) || null,
                observacoes: document.getElementById('observacoesInvestimento').value
            };
            
            try {
                const response = await fetch('/api/financeiro/investimentos', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(investimento)
                });
                
                if (response.ok) {
                    document.getElementById('modalInvestimento').classList.add('hidden');
                    document.getElementById('modalInvestimento').classList.remove('flex');
                    document.getElementById('formInvestimento').reset();
                    loadInvestimentos();
                }
            } catch (error) {
                console.error('Erro ao salvar investimento:', error);
            }
        }

        async function deletarInvestimento(investimentoId) {
            if (confirm('Tem certeza que deseja deletar este investimento?')) {
                try {
                    const response = await fetch(`/api/financeiro/investimentos/${investimentoId}`, {
                        method: 'DELETE',
                        headers
                    });
                    
                    if (response.ok) {
                        loadInvestimentos();
                    }
                } catch (error) {
                    console.error('Erro ao deletar investimento:', error);
                }
            }
        }

        // Funções de filtro
        function filtrarContasPagar() {
            const status = document.getElementById('filtro-status-pagar').value;
            const categoria = document.getElementById('filtro-categoria-pagar').value;
            const mes = document.getElementById('filtro-mes-pagar').value;
            
            // Implementar filtros aqui
            loadContasPagar();
        }

        function filtrarContasReceber() {
            const status = document.getElementById('filtro-status-receber').value;
            const categoria = document.getElementById('filtro-categoria-receber').value;
            const mes = document.getElementById('filtro-mes-receber').value;
            
            // Implementar filtros aqui
            loadContasReceber();
        }

        function filtrarInvestimentos() {
            const tipo = document.getElementById('filtro-tipo-investimento').value;
            const ativo = document.getElementById('filtro-status-investimento').value;
            
            // Implementar filtros aqui
            loadInvestimentos();
        }

        // ==================== FUNÇÕES DE EDIÇÃO ====================
        
        // Editar Conta a Pagar
        async function editarContaPagar(contaId) {
            try {
                const response = await fetch(`/api/financeiro/contas-pagar/${contaId}`, { headers });
                const conta = await response.json();
                
                // Preencher modal
                document.getElementById('editarContaPagarId').value = conta.id;
                document.getElementById('editarDescricaoPagar').value = conta.descricao;
                document.getElementById('editarValorPagar').value = formatarValorParaInput(conta.valor);
                document.getElementById('editarVencimentoPagar').value = conta.data_vencimento;
                document.getElementById('editarCategoriaPagar').value = conta.categoria;
                document.getElementById('editarStatusPagar').value = conta.status;
                document.getElementById('editarObservacoesPagar').value = conta.observacoes || '';
                
                // Mostrar modal
                const modal = document.getElementById('modalEditarContaPagar');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                lucide.createIcons();
            } catch (error) {
                console.error('Erro ao carregar conta a pagar:', error);
                alert('Erro ao carregar dados da conta');
            }
        }
        
        async function salvarEdicaoContaPagar() {
            const contaId = document.getElementById('editarContaPagarId').value;
            const conta = {
                descricao: document.getElementById('editarDescricaoPagar').value,
                valor: converterMoedaParaNumero(document.getElementById('editarValorPagar').value),
                data_vencimento: document.getElementById('editarVencimentoPagar').value,
                categoria: document.getElementById('editarCategoriaPagar').value,
                status: document.getElementById('editarStatusPagar').value,
                observacoes: document.getElementById('editarObservacoesPagar').value
            };
            
            try {
                const response = await fetch(`/api/financeiro/contas-pagar/${contaId}`, {
                    method: 'PUT',
                    headers,
                    body: JSON.stringify(conta)
                });
                
                if (response.ok) {
                    document.getElementById('modalEditarContaPagar').classList.add('hidden');
                    document.getElementById('modalEditarContaPagar').classList.remove('flex');
                    loadContasPagar();
                    alert('Conta atualizada com sucesso!');
                } else {
                    const error = await response.json();
                    alert('Erro ao atualizar conta: ' + error.detail);
                }
            } catch (error) {
                console.error('Erro ao atualizar conta a pagar:', error);
                alert('Erro de conexão: ' + error.message);
            }
        }
        
        // Editar Conta a Receber
        async function editarContaReceber(contaId) {
            try {
                const response = await fetch(`/api/financeiro/contas-receber/${contaId}`, { headers });
                const conta = await response.json();
                
                // Preencher modal
                document.getElementById('editarContaReceberId').value = conta.id;
                document.getElementById('editarDescricaoReceber').value = conta.descricao;
                document.getElementById('editarValorReceber').value = formatarValorParaInput(conta.valor);
                document.getElementById('editarVencimentoReceber').value = conta.data_vencimento;
                document.getElementById('editarCategoriaReceber').value = conta.categoria;
                document.getElementById('editarStatusReceber').value = conta.status;
                document.getElementById('editarObservacoesReceber').value = conta.observacoes || '';
                
                // Mostrar modal
                const modal = document.getElementById('modalEditarContaReceber');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                lucide.createIcons();
            } catch (error) {
                console.error('Erro ao carregar conta a receber:', error);
                alert('Erro ao carregar dados da conta');
            }
        }
        
        async function salvarEdicaoContaReceber() {
            const contaId = document.getElementById('editarContaReceberId').value;
            const conta = {
                descricao: document.getElementById('editarDescricaoReceber').value,
                valor: converterMoedaParaNumero(document.getElementById('editarValorReceber').value),
                data_vencimento: document.getElementById('editarVencimentoReceber').value,
                categoria: document.getElementById('editarCategoriaReceber').value,
                status: document.getElementById('editarStatusReceber').value,
                observacoes: document.getElementById('editarObservacoesReceber').value
            };
            
            try {
                const response = await fetch(`/api/financeiro/contas-receber/${contaId}`, {
                    method: 'PUT',
                    headers,
                    body: JSON.stringify(conta)
                });
                
                if (response.ok) {
                    document.getElementById('modalEditarContaReceber').classList.add('hidden');
                    document.getElementById('modalEditarContaReceber').classList.remove('flex');
                    loadContasReceber();
                    alert('Conta atualizada com sucesso!');
                } else {
                    const error = await response.json();
                    alert('Erro ao atualizar conta: ' + error.detail);
                }
            } catch (error) {
                console.error('Erro ao atualizar conta a receber:', error);
                alert('Erro de conexão: ' + error.message);
            }
        }
        
        // Editar Meta
        async function editarMeta(metaId) {
            try {
                const response = await fetch(`/api/financeiro/metas/${metaId}`, { headers });
                const meta = await response.json();
                
                // Preencher modal
                document.getElementById('editarMetaId').value = meta.id;
                document.getElementById('editarTituloMeta').value = meta.titulo;
                document.getElementById('editarDescricaoMeta').value = meta.descricao || '';
                document.getElementById('editarValorMeta').value = formatarValorParaInput(meta.valor_meta);
                document.getElementById('editarInicioMeta').value = meta.data_inicio;
                document.getElementById('editarDataMeta').value = meta.data_meta;
                document.getElementById('editarStatusMeta').value = meta.status;
                document.getElementById('editarCorMeta').value = meta.cor || '#3B82F6';
                
                // Mostrar modal
                const modal = document.getElementById('modalEditarMeta');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                lucide.createIcons();
            } catch (error) {
                console.error('Erro ao carregar meta:', error);
                alert('Erro ao carregar dados da meta');
            }
        }
        
        async function salvarEdicaoMeta() {
            const metaId = document.getElementById('editarMetaId').value;
            const meta = {
                titulo: document.getElementById('editarTituloMeta').value,
                descricao: document.getElementById('editarDescricaoMeta').value,
                valor_meta: converterMoedaParaNumero(document.getElementById('editarValorMeta').value),
                data_inicio: document.getElementById('editarInicioMeta').value,
                data_meta: document.getElementById('editarDataMeta').value,
                status: document.getElementById('editarStatusMeta').value,
                cor: document.getElementById('editarCorMeta').value
            };
            
            try {
                const response = await fetch(`/api/financeiro/metas/${metaId}`, {
                    method: 'PUT',
                    headers,
                    body: JSON.stringify(meta)
                });
                
                if (response.ok) {
                    document.getElementById('modalEditarMeta').classList.add('hidden');
                    document.getElementById('modalEditarMeta').classList.remove('flex');
                    loadMetas();
                    alert('Meta atualizada com sucesso!');
                } else {
                    const error = await response.json();
                    alert('Erro ao atualizar meta: ' + error.detail);
                }
            } catch (error) {
                console.error('Erro ao atualizar meta:', error);
                alert('Erro de conexão: ' + error.message);
            }
        }
        
        // Editar Investimento
        async function editarInvestimento(investimentoId) {
            try {
                const response = await fetch(`/api/financeiro/investimentos/${investimentoId}`, { headers });
                const investimento = await response.json();
                
                // Preencher modal
                document.getElementById('editarInvestimentoId').value = investimento.id;
                document.getElementById('editarNomeInvestimento').value = investimento.nome;
                document.getElementById('editarTipoInvestimento').value = investimento.tipo;
                document.getElementById('editarValorInvestido').value = formatarValorParaInput(investimento.valor_investido);
                document.getElementById('editarValorAtual').value = formatarValorParaInput(investimento.valor_atual);
                document.getElementById('editarDataInvestimento').value = investimento.data_investimento;
                document.getElementById('editarRentabilidadeAnual').value = investimento.rentabilidade_anual || '';
                document.getElementById('editarAtivoInvestimento').value = investimento.ativo.toString();
                document.getElementById('editarObservacoesInvestimento').value = investimento.observacoes || '';
                
                // Mostrar modal
                const modal = document.getElementById('modalEditarInvestimento');
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                lucide.createIcons();
            } catch (error) {
                console.error('Erro ao carregar investimento:', error);
                alert('Erro ao carregar dados do investimento');
            }
        }
        
        async function salvarEdicaoInvestimento() {
            const investimentoId = document.getElementById('editarInvestimentoId').value;
            const investimento = {
                nome: document.getElementById('editarNomeInvestimento').value,
                tipo: document.getElementById('editarTipoInvestimento').value,
                valor_investido: converterMoedaParaNumero(document.getElementById('editarValorInvestido').value),
                valor_atual: converterMoedaParaNumero(document.getElementById('editarValorAtual').value),
                data_investimento: document.getElementById('editarDataInvestimento').value,
                rentabilidade_anual: parseFloat(document.getElementById('editarRentabilidadeAnual').value) || null,
                ativo: document.getElementById('editarAtivoInvestimento').value === 'true',
                observacoes: document.getElementById('editarObservacoesInvestimento').value
            };
            
            try {
                const response = await fetch(`/api/financeiro/investimentos/${investimentoId}`, {
                    method: 'PUT',
                    headers,
                    body: JSON.stringify(investimento)
                });
                
                if (response.ok) {
                    document.getElementById('modalEditarInvestimento').classList.add('hidden');
                    document.getElementById('modalEditarInvestimento').classList.remove('flex');
                    loadInvestimentos();
                    alert('Investimento atualizado com sucesso!');
                } else {
                    const error = await response.json();
                    alert('Erro ao atualizar investimento: ' + error.detail);
                }
            } catch (error) {
                console.error('Erro ao atualizar investimento:', error);
                alert('Erro de conexão: ' + error.message);
            }
        }

        // Aplicar máscaras de moeda em todos os inputs de valor
        function aplicarMascarasMoeda() {
            // Campos de criação
            const camposValor = [
                'valorPagar', 'valorReceber', 'valorMeta', 'valorInvestido', 'valorAtual', 'valorTransacao',
                'editarValorPagar', 'editarValorReceber', 'editarValorMeta', 'editarValorInvestido', 'editarValorAtual'
            ];
            
            camposValor.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    aplicarMascaraMoeda(input);
                }
            });
        }

        // Inicializar página
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar se há token
            if (!token) {
                window.location.href = '/login';
                return;
            }
            
            // Aplicar máscaras de moeda
            aplicarMascarasMoeda();
            
            // Event listeners para conta parcelada
            document.getElementById('valorTotalParcelada').addEventListener('input', calcularValorParcela);
            document.getElementById('totalParcelas').addEventListener('input', calcularValorParcela);
            document.getElementById('dataPrimeiraParcela').addEventListener('change', gerarPreviaParcelas);
            
            // Carregar dashboard inicial
            loadDashboard();
        });

        // ==================== FUNCIONALIDADES MENSAIS ====================
        
        // Variáveis para controle mensal
        let mesAtual = new Date().getMonth() + 1;
        let anoAtual = new Date().getFullYear();
        
        // Função para alterar mês
        function alterarMes(direcao) {
            mesAtual += direcao;
            
            if (mesAtual > 12) {
                mesAtual = 1;
                anoAtual++;
            } else if (mesAtual < 1) {
                mesAtual = 12;
                anoAtual--;
            }
            
            atualizarDisplayMes();
            recarregarDadosMensais();
        }
        
        // Atualizar display do mês
        function atualizarDisplayMes() {
            const meses = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            document.getElementById('mes-nome').textContent = `${meses[mesAtual-1]} ${anoAtual}`;
        }
        
        // Recarregar todos os dados mensais
        function recarregarDadosMensais() {
            // Recarregar dashboard com dados do mês selecionado
            loadDashboard();
            
            // Recarregar contas a pagar do mês
            loadContasPagar();
            
            // Recarregar contas a receber do mês
            loadContasReceber();
            
            // Recarregar metas mensais
            loadMetasMensais();
            
            // Recarregar investimentos do mês
            loadInvestimentos();
        }
        
        // Carregar metas mensais
        async function loadMetasMensais() {
            try {
                const response = await fetch(`/api/financeiro/metas-mensais?mes=${mesAtual}&ano=${anoAtual}`, { headers });
                const metas = await response.json();
                
                // Atualizar status das metas
                if (metas.length > 0) {
                    const meta = metas[0];
                    atualizarStatusMetasMensais(meta);
                } else {
                    limparStatusMetasMensais();
                }
                
                // Atualizar lista de metas
                atualizarListaMetasMensais(metas);
                
            } catch (error) {
                console.error('Erro ao carregar metas mensais:', error);
            }
        }
        
        // Atualizar status das metas mensais
        function atualizarStatusMetasMensais(meta) {
            document.getElementById('percentual-receita-mensal').textContent = `${meta.percentual_receita}%`;
            document.getElementById('barra-receita-mensal').style.width = `${Math.min(meta.percentual_receita, 100)}%`;
            document.getElementById('valor-receita-mensal').textContent = 
                `${formatarMoeda(meta.receita_realizada)} / ${formatarMoeda(meta.meta_receita)}`;
            
            document.getElementById('percentual-despesa-mensal').textContent = `${meta.percentual_despesa}%`;
            document.getElementById('barra-despesa-mensal').style.width = `${Math.min(meta.percentual_despesa, 100)}%`;
            document.getElementById('valor-despesa-mensal').textContent = 
                `${formatarMoeda(meta.despesa_realizada)} / ${formatarMoeda(meta.meta_despesa)}`;
            
            document.getElementById('percentual-investimento-mensal').textContent = `${meta.percentual_investimento}%`;
            document.getElementById('barra-investimento-mensal').style.width = `${Math.min(meta.percentual_investimento, 100)}%`;
            document.getElementById('valor-investimento-mensal').textContent = 
                `${formatarMoeda(meta.investimento_realizado)} / ${formatarMoeda(meta.meta_investimento)}`;
            
            document.getElementById('percentual-poupanca-mensal').textContent = `${meta.percentual_poupanca}%`;
            document.getElementById('barra-poupanca-mensal').style.width = `${Math.min(meta.percentual_poupanca, 100)}%`;
            document.getElementById('valor-poupanca-mensal').textContent = 
                `${formatarMoeda(meta.poupanca_realizada)} / ${formatarMoeda(meta.meta_poupanca)}`;
            
            // Atualizar status geral
            const statusClasses = {
                'excelente': 'bg-green-100 text-green-800',
                'bom': 'bg-blue-100 text-blue-800',
                'regular': 'bg-yellow-100 text-yellow-800',
                'ruim': 'bg-red-100 text-red-800'
            };
            const statusElement = document.getElementById('status-geral-mensal');
            statusElement.textContent = `Status: ${meta.status_geral.charAt(0).toUpperCase() + meta.status_geral.slice(1)}`;
            statusElement.className = `px-3 py-1 rounded-full text-sm font-medium ${statusClasses[meta.status_geral] || 'bg-gray-100 text-gray-800'}`;
        }
        
        // Limpar status das metas mensais
        function limparStatusMetasMensais() {
            document.getElementById('percentual-receita-mensal').textContent = '0%';
            document.getElementById('barra-receita-mensal').style.width = '0%';
            document.getElementById('valor-receita-mensal').textContent = 'R$ 0,00 / R$ 0,00';
            
            document.getElementById('percentual-despesa-mensal').textContent = '0%';
            document.getElementById('barra-despesa-mensal').style.width = '0%';
            document.getElementById('valor-despesa-mensal').textContent = 'R$ 0,00 / R$ 0,00';
            
            document.getElementById('percentual-investimento-mensal').textContent = '0%';
            document.getElementById('barra-investimento-mensal').style.width = '0%';
            document.getElementById('valor-investimento-mensal').textContent = 'R$ 0,00 / R$ 0,00';
            
            document.getElementById('percentual-poupanca-mensal').textContent = '0%';
            document.getElementById('barra-poupanca-mensal').style.width = '0%';
            document.getElementById('valor-poupanca-mensal').textContent = 'R$ 0,00 / R$ 0,00';
            
            document.getElementById('status-geral-mensal').textContent = 'Status: Sem metas';
            document.getElementById('status-geral-mensal').className = 'px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800';
        }
        
        // Atualizar lista de metas mensais
        function atualizarListaMetasMensais(metas) {
            const container = document.getElementById('lista-metas-mensais');
            
            if (metas.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <i data-lucide="calendar" class="w-16 h-16 mx-auto text-gray-400 mb-4"></i>
                        <p class="text-gray-500 mb-4">Nenhuma meta mensal encontrada para ${mesAtual}/${anoAtual}</p>
                        <button onclick="criarMetaMensal()" class="px-4 py-2 bg-tce-main text-white rounded-lg hover:bg-emerald-700 transition flex items-center gap-2 mx-auto">
                            <i data-lucide="plus" class="w-4 h-4"></i>Criar Meta Mensal
                        </button>
                    </div>
                `;
                lucide.createIcons();
                return;
            }
            
            let html = '';
            metas.forEach(meta => {
                const statusClasses = {
                    'excelente': 'success',
                    'bom': 'primary',
                    'regular': 'warning',
                    'ruim': 'danger'
                };
                
                const statusBadgeTailwind = meta.status_geral === 'excelente' ? 'bg-green-100 text-green-800' :
                                           meta.status_geral === 'bom' ? 'bg-blue-100 text-blue-800' :
                                           meta.status_geral === 'regular' ? 'bg-yellow-100 text-yellow-800' :
                                           'bg-red-100 text-red-800';
                html += `
                    <div class="bg-white rounded-lg border border-gray-200 p-4 mb-4 hover:shadow-md transition">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                            <div class="flex-1">
                                <h6 class="font-semibold mb-2">Meta de ${mesAtual}/${anoAtual}</h6>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <p class="text-gray-600">Receitas: <span class="font-medium">${meta.percentual_receita}%</span></p>
                                    <p class="text-gray-600">Despesas: <span class="font-medium">${meta.percentual_despesa}%</span></p>
                                </div>
                            </div>
                            <div class="flex flex-col md:items-end gap-2">
                                <span class="px-3 py-1 rounded-full text-xs font-medium ${statusBadgeTailwind}">${meta.status_geral}</span>
                                <div class="flex gap-2">
                                    <button onclick="editarMetaMensal(${meta.id})" class="p-2 border border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                    </button>
                                    <button onclick="deletarMetaMensal(${meta.id})" class="p-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition">
                                        <i data-lucide="trash" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            lucide.createIcons();
        }
        
        // Criar meta mensal
        function criarMetaMensal() {
            // Implementar modal para criar meta mensal
            alert('Funcionalidade de criar meta mensal será implementada');
        }
        
        // Editar meta mensal
        function editarMetaMensal(metaId) {
            // Implementar edição de meta mensal
            alert('Funcionalidade de editar meta mensal será implementada');
        }
        
        // Deletar meta mensal
        async function deletarMetaMensal(metaId) {
            if (confirm('Tem certeza que deseja deletar esta meta mensal?')) {
                try {
                    const response = await fetch(`/api/financeiro/metas-mensais/${metaId}`, {
                        method: 'DELETE',
                        headers
                    });
                    
                    if (response.ok) {
                        loadMetasMensais();
                        alert('Meta mensal deletada com sucesso!');
                    } else {
                        alert('Erro ao deletar meta mensal');
                    }
                } catch (error) {
                    console.error('Erro ao deletar meta mensal:', error);
                    alert('Erro de conexão');
                }
            }
        }
        
        // Modificar função showSection para incluir metas-mensais
        function showSection(section) {
            // Esconder todas as seções
            document.querySelectorAll('.content-section').forEach(el => {
                el.style.display = 'none';
            });
            
            // Remover classe active de todos os links
            document.querySelectorAll('.nav-link').forEach(el => {
                el.classList.remove('active');
            });
            
            // Mostrar seção selecionada
            const targetSection = document.getElementById(section + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // Adicionar classe active ao link
            event.target.classList.add('active');
            
            // Carregar dados específicos da seção
            switch(section) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'contas-pagar':
                    loadContasPagar();
                    break;
                case 'contas-receber':
                    loadContasReceber();
                    break;
                case 'metas':
                    loadMetas();
                    break;
                case 'metas-mensais':
                    loadMetasMensais();
                    break;
                case 'investimentos':
                    loadInvestimentos();
                    break;
                case 'relatorios':
                    loadRelatorios();
                    break;
            }
        }
        
        // ==================== FUNCIONALIDADES DE DASHBOARD ====================
        
        // Obter modo do dashboard selecionado
        function obterModoDashboard() {
            const modoSelecionado = document.querySelector('input[name="dashboard-mode"]:checked');
            return modoSelecionado ? modoSelecionado.value : 'mensal';
        }
        
        // Atualizar labels do dashboard baseado no modo
        function atualizarLabelsDashboard(modo) {
            const meses = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            
            if (modo === 'mensal') {
                document.getElementById('saldo-label').textContent = 'Saldo do Mês';
                document.getElementById('receitas-label').textContent = 'Receitas do Mês';
                document.getElementById('despesas-label').textContent = 'Despesas do Mês';
                document.getElementById('investimentos-label').textContent = 'Investimentos do Mês';
                
                document.getElementById('saldo-periodo').textContent = `${meses[mesAtual-1]} ${anoAtual}`;
                document.getElementById('receitas-periodo').textContent = `${meses[mesAtual-1]} ${anoAtual}`;
                document.getElementById('despesas-periodo').textContent = `${meses[mesAtual-1]} ${anoAtual}`;
                document.getElementById('investimentos-periodo').textContent = `${meses[mesAtual-1]} ${anoAtual}`;
                
            } else if (modo === 'anual') {
                document.getElementById('saldo-label').textContent = 'Saldo do Ano';
                document.getElementById('receitas-label').textContent = 'Receitas do Ano';
                document.getElementById('despesas-label').textContent = 'Despesas do Ano';
                document.getElementById('investimentos-label').textContent = 'Investimentos do Ano';
                
                document.getElementById('saldo-periodo').textContent = `Ano ${anoAtual}`;
                document.getElementById('receitas-periodo').textContent = `Ano ${anoAtual}`;
                document.getElementById('despesas-periodo').textContent = `Ano ${anoAtual}`;
                document.getElementById('investimentos-periodo').textContent = `Ano ${anoAtual}`;
                
            } else if (modo === 'total') {
                document.getElementById('saldo-label').textContent = 'Saldo Total';
                document.getElementById('receitas-label').textContent = 'Receitas Totais';
                document.getElementById('despesas-label').textContent = 'Despesas Totais';
                document.getElementById('investimentos-label').textContent = 'Investimentos Totais';
                
                document.getElementById('saldo-periodo').textContent = 'Todos os períodos';
                document.getElementById('receitas-periodo').textContent = 'Todos os períodos';
                document.getElementById('despesas-periodo').textContent = 'Todos os períodos';
                document.getElementById('investimentos-periodo').textContent = 'Todos os períodos';
            }
        }
        
        // Adicionar event listeners para mudança de modo
        function configurarEventListenersDashboard() {
            // Event listeners para mudança de modo
            document.querySelectorAll('input[name="dashboard-mode"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    loadDashboard();
                });
            });
        }
        
        // Inicializar display do mês
        atualizarDisplayMes();
        
        // Configurar event listeners do dashboard
        configurarEventListenersDashboard();
    </script>
</body>
</html>

